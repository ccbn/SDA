<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Page Template</title>
        <script type="text/javascript" src="d3.js"></script>
        <link rel="stylesheet" href="css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <style>
          .h2
          {
            font-family: Georgia;
            font-weight: bold;
            font-size: 36px;
          }
          .p-custom
          {
            font-family: Georgia;
            font-size: 14px;
            line-height: 1.6em;
          }
          .line
          {
            stroke: blue;
            fill: none;
          }
        </style>
    </head>
    <body>
        <script type="text/javascript">
        var colors = ["green", "red", "yellow", "orange", "purple"];
        var width = 700;
        var height = 700;
        
        //Create SVG element
        

        function loadMap(callback) {
          d3.json("NYC.json", function(json) {
              var projection = d3.geoMercator();
              var path = d3.geoPath().projection(projection);

              projection
                .scale(1)
                .translate([0, 0]);

              var b = path.bounds(json);
              var s = 0.95/Math.max((b[1][0] - b[0][0])/width, (b[1][1] - b[0][1])/height);
              var t = [(width - s * (b[1][0] + b[0][0]))/2, (height - s * (b[1][1] + b[0][1]))/2];

              projection
                .scale(s)
                .translate(t);

              var svgMap = d3.select("body")
              .append("svg")
              .attr("width", width)
              .attr("height", height);

              svgMap.selectAll("path")
              .data(json.features)
              .enter()
              .append("path")
              .attr("d", path);

              callback(json,path,projection,svgMap);
            });
        };
                  
        var rowConverter = function(row) {
          return {
            Address: row.address,
            Lat: parseFloat(row.lat),
            Long: parseFloat(row.lon)
          };
        };

        d3.csv("./data/coord-0-1700.csv", rowConverter, function(data) {
          loadMap(function(json,path,projection,svgMap) {
            svgMap.append("g")
              .selectAll("circle")
              .data(data)
              .enter()
              .append("circle")
              .attr("cx", function(d) {
                return projection([d.Long, d.Lat])[0];
              })
              .attr("cy", function(d) {
                return projection([d.Long, d.Lat])[1];
              })
              .attr("r", function(d) {
                return 3;
              })
              .attr("fill", "black")
              .attr("stroke", "white");
          });

          
        });
    		</script>

    </body>
</html>
