<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <title>D3 Page Template</title>
      <script type="text/javascript" src="d3.js"></script>
      <style>
        .h2
        {
          font-family: Georgia;
          font-weight: bold;
          font-size: 36px;
        }
        .p-custom
        {
          font-family: Georgia;
          font-size: 14px;
          line-height: 1.6em;
        }
        .graphText
        {
          font-family: Georgia;
          font-weight: bold;
          font-size: 30px;
        }
        .line
        {
          stroke: green;
          fill: white;
        }

        .line2
        {
          stroke: red;
          fill: white;
        }

      </style>
  </head>
  <body>
    <div id="Part1">
    <h2>Part 1: DAOST Chapter 2 Questions</h2>
    <h3>Explain in your own words the point of the jitter plot.</h3>
    <p>The point of a jitter plot is to se where the data is clustered together</p>
    <h3>Explain in your own words the point of figure 2-3. (I'm going to skip saying "in your own words" going forward, but I hope
      you get the point; I expect all answers to be in your own words)</h3>
    <p>The point in figure 2-3 is that dependent on the alignment of your bins the graph can look totaly different but the data is
      the same.</p>
    <h3>The author of DAOST (Philipp Janert) likes KDEs (and think they're better than histograms). And I don't. I didn't give a
      detailed explanation in the video, but now that works to my advantage. I'll ask you guys to think about this and thereby
      create an excellent exercise: When can KDEs be misleading?</h3>
    <p>The KDE can be misleading if we set bandwidth to low or to high then the curve of the graph will be very fladt or have a
      lot of very sharp peaks.</p>
    <h3>I've discussed some strengths of the CDF - there are also weaknesses. Janert writes "[CDFs] have less intuitive appeal
      than histograms of KDEs". What does he mean by that?</h3>
    <p>The reason for this is that we humen is beder to judge the distance then we are to judge the area under a curve this then
      leads us to missjudge the data.</p>
    <h3>What is a Quantile plot? What is it good for.</h3>
    <p>It is a reverse of the CDF plot, it is good for if you want to know how big a procentage of the data is under a certain value.</p>
    <h3>How is a Probability plot defined? What is it useful for? Have you ever seen one before?</h3>
    <p>This is how the Probability plot is defined x<sub>i</sub>=μ+σ&Phi;<sup>-1</sup>(y<sub>i</sub>). It is useful to spot diviations
      in the plot because if the data is a perfect Gaussian distribution the plot will be a strait line so if there is any point
      that is not on the line then they are a diviation. Yes we have seen one before in curse 02450 Introduction to Machine Learning and
      Data Mining</p>
    <h3>One of the reasons I like DAOST is that Janert is so suspicious of mean, median, and related summary statistics. Explain why
      one has to be careful when using those - and why visualization of the full data is always better.</h3>
    <p>The reason that you have to be carefull when using mean and standard diviation is if the data is not symmetric and well
      behaved then the values will be misleading. where as the median will be better to use because if the data is symmetric and well
      behaved then the median and percentile vill be close to the mean and standard diviation but but when the data is not then the
      median and percentile is still good to use.</p>
    <h3>I love box plots. When are box plots most useful?</h3>
    <p>If you want to visualization the distribution of the data.</p>
    <h3>The book doesn't mention violin plots. Are those better or worse than box plots? Why?</h3>
    <p>They are the same as box plot except that they also show the Probability density but the Probability density could be a good
      thing to have. Because it can give a idear about if it is something that you should look closer at where in the box plot you
      have to make a seperate analysis of the Probability density to se if there is some interesting information it that part.</p>
    </div>

    <div id="Part2">
		<h2>Part 2: DAOST Chapter 3 Questions</h2>
		<h3>Looking at Fig 3-1, Janert writes "the data itself shows clearly that the amount of random noise in the data is small".
			What do you think his argument is?</h3>
		<p>
			He is confident that the amount of random noise is small because the data follows smooth curves. It clearly follows a pattern. If there was some data breaking the pattern,
			then it would probabily be noise in the data. We do not see a single point outside the pattern, therefore low noise in data.
		</p>
		<h3>Can you think of a real-world example of a multivariate relationship like the one in Fig 3-3 (lower right panel)?</h3>
		<p>
			An example of a multivariate relationship could be the measure of the effectiveness of a treatment on an infection over time. The x-axis shows the time and the y-axis shows the infection number.
			Each point would represent af measure of the infection number on a patient after a certain time when the treatment began. The treatment could therefore have different results depending on the patient groups. For instance, young people could be affected different than older people.
		</p>
		<h3>What are the two methods Janert metions for smoothing noisy data? Can you think of other ones?</h3>
		<p>
			The two methods mentioned are Spline and LOSS. There are other smoothing methods existing. We did not know any ourselfs, but we found out online that there are multiple ones:
		</p>
		<ul>
				<li>Additive smoothing</li>
				<li>Laplacian smoothing</li>
				<li>Butterworth filter</li>
		</ul>
		<p>
			Depending on what kind of data you have you will apply a specific method for smoothing it out.
		</p>
		<h3>What are residuals? Why is it a good idea to plot the residuals of your fit?</h3>
		<p>The residuals are the measure of error of the model compared to the real data. Plotting residuals means you can
		easily tell how correct your model is. If the residual plot shows your model is very far off from the true values, then you should consider to change your model to fit the data.
		</p>
		<h3>Explain in your own words the point of the smooth tube in figure 3-7.</h3>
		<p>
			The smooth tube is useful for predicting values. For instance in figure 3-7, you can assume most of the results in year 1920 was between 142 and 150. You can also extent the smoothing curves to include the future to predict future values.
			This is useful if you want to predict what the expected results of marathon runners are in the future. The danger of extenting the smoothing curves is that the model based on historic data is not neccesarily a good estimator for predicting the future.
		</p>
		<h3>What kind of relationships will a semi-log plot help you discover?</h3>
		<p>
			The semi-log plot can help you discover the relationship between x and y is exponential. If you take the log of y as a function of x, the plot will show either the data following a straight line or not. If it follows a straight line, then we know the relationship of x and y is exponential otherwise not.
		</p>
		<h3>What kind of functions will loglog plots help you see?</h3>
		<p>The loglog plots can help you discover power-law relationship of x and y. For instance, their example shows that the heart rate of an animal is related to the mass of the animal. Specifically it shows f ~ m<sup>-1/4</sup> where m is the mass and f is the heart rate.
		Notice it does not specifically tell the heart rate size but only the relationship between x and y.
		</p>
		<h3>What the h#ll is banking and what element from our visual system does it use to help us see patterns? What are potential problems with banking?</h3>
		<p>
      Banking is a graphical method where you change the aspect ratio of the plot.
      For instance, stretching the vertical direction of the whole plot will change the aspect ratio and it will be easier to see smaller changes in the vertical direction.
      The disadvantage is that if the aspect ratio is really off it can be misleading. For example a big jump in a plot can in reality be a very small change in the data.
    </p>
    <h3>I think figure 3-14 makes an important point about linear fits that is rarely made. What is it?</h3>
    <p>
      The point is that if the data is linear, the model should be the same indpendent of the input and response variable chosen.
      If the same data gives two significantly different models just by swapping the input and response variable then the conclusion is that a linear model is not a good one.
    </p>
    <h3>Summarize the discussion of Graphical Analysis and Presentation Graphics on pp. 68-69 in your own words.</h3>
    <p>
      There exists two purposes of visualizing data. The first is graphical analysis, also known as exploration in this course, and the second is presentation graphics, also known as explaining graphics.
    Graphical analysis is an analysis of data using graphics. Multiple plots should be created to see the data in different perspectives. You do not neccesarily know what you are looking for, only more insight.
    Presentation graphics is the focused on presenting data that is already understood maybe by doing a graphical analysis first.
    The presenting graphics should be easily understood and take into account who is the reader.
    </p>
    </div>

    <div id="Part3">
    <h2>Part 3: Viz 1</h2>
    <p>This is a reproduction of <a href="http://iquantny.tumblr.com/post/129373499164/this-is-quantifiably-the-best-month-to-go-to-the">
      http://iquantny.tumblr.com/post/129373499164/this-is-quantifiably-the-best-month-to-go-to-the</a></p>
    <h2 class="h2">This is Quantifiably the Best Month to go to the Farmers Market</h2>
    <p class="p-custom">As part of a homework assignment, I ask my students at Pratt to go out and chart something of interest to them, and
      <a href="https://www.linkedin.com/in/kvsavarese/">Katherine Savarese</a> came back with a simple chart about farmers markets
      that I loved- it inspired this post.</p>
    <p class="p-custom">You probably know that farmers markets are a staple across <a href="http://www.grownyc.org/files/gmkt/map.pdf">all five boroughs</a> of New York City, but September happens to be a
      very special month. Why is that?  Well, it turns out September is the month with the most unique types of fresh produce- forty
      three to be exact.</p>
    <p class="p-custom">To show the current offerings, we charted how many types of fruits and vegetables are available by month, and showed if they
      were fresh or from storage.</p>

    <script type="text/javascript">
      var w = 500;
      var w2 = w + 300;
      var h = 300;
      var h2 = 400;
      var numberOfMoth = 12;
      var padding = 25;
      var padding2 = 25;
			var rowC = function(d) {
				return {a: "he", b: d.hej};
			}
			var rowConverter = function(row) {
				return {
					Index: parseInt(row.Index),
					Category: row.Category,
					Freshness: row.Freshness,
					Jan: parseInt(row.Jan),
					Feb: parseInt(row.Feb),
					Mar: parseInt(row.Mar),
					Apr: parseInt(row.Apr),
					May: parseInt(row.May),
					Jun: parseInt(row.Jun),
					Jul: parseInt(row.Jul),
					Aug: parseInt(row.Aug),
					Sep: parseInt(row.Sep),
					Oct: parseInt(row.Oct),
					Nov: parseInt(row.Nov),
					Dec: parseInt(row.Dec)
				};
			};
      var dataset;
      var months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
      var ukpData = [];

      //Main function call. Retrieves data from file and runs an ananoymous
      //function that creates the visualizations.
      //The
			d3.csv("data.csv", rowConverter, function(data) {
        dataset = data;

        ukpData = ExtractUKP(dataset); //Extract UKP numbers for each month and produce

        //Create scaling objects
        var xScale = GetXScale();
        var yScale = GetYScale();
        //Create SVG and group elements for better structure
        var elements = CreateSvgAndGroupElements();

        //Create the labels to the right of the graph
        CreateGraphLabelRects(elements.graphLabels);
        CreateGraphLabels(elements.graphLabels,elements.svg,yScale);
        //Create the bars in the graph
        CreateBars(elements.graph,xScale,yScale);
        //Create the X and Y axises
        CreateYAxis(elements.svg,yScale);
        CreateXAxis(elements.svg,xScale);

        //Create title above graph
        CreateGraphTitle(elements.svg);
      });
      var GetXScale = function() {
        var xScale = d3.scaleBand()
          .domain(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"])
          .range([0 + padding, w])
          .paddingInner(0.05);
        return xScale;
      }
      var GetYScale = function() {
        var yScale = d3.scaleLinear()
							.domain([0, d3.max(ukpData[0])])
							.range([h - padding, 0 + padding /*+ (h2 -h)*/]);
        return yScale;
      }
      var CreateYAxis = function(svg,yScale) {
        var yAxis = d3.axisLeft(yScale)
          .ticks(5);
        svg.select("#graph").append("h1");
        svg.select("#graph").append("g")
   				.attr("class", "y axis")
          .attr("transform", "translate(" + padding + ",0)")
   				.call(yAxis);
      }
      var CreateXAxis = function(svg,xScale) {
        var xAxis = d3.axisBottom(xScale)
          .ticks(12);
          svg.select("#graph").append("g")
   				.attr("class", "x axis")
          .attr("transform", "translate(0," + (h - padding) + ")")
   				.call(xAxis);
      }

      var CreateGraphTitle = function(svg) {
        svg.append("g")
        .append("text")
        .attr("class", "graphText")
        .text("NYC Green Markets - Unique Produce Types")
        .attr("x", padding)
        .attr("y", (h2-h)/2)
        .attr("width", w2)
        .attr("height", 0);
      };
      var CreateSvgAndGroupElements = function() {
        var svg = d3.select("body")
						.append("svg")
						.attr("width", w2)
						.attr("height", h2);

        var graphLabelsElem = svg.append("g")
          .attr("id", "rect")
          .attr("clip-path", "url(#chart-area)")
          .attr("transform", "translate(0, 100)");

        var graphElem = svg.append("g")
          .attr("id", "graph")
          .attr("clip-path", "url(#chart-area)")
          .attr("transform", "translate(0, 100)");
          return {
            svg: svg,
            graphLabels: graphLabelsElem,
            graph: graphElem
          };
        }
        var CreateBars = function(element,xScale,yScale) {
          element
          .selectAll("rect")
          .data(ukpData[0])
          .enter()
          .append("rect")
          .attr("x", function(d, i) {
  			   		return xScale(months[i]);	//Bar width of 20 plus 1 for padding
  			   })
          .attr("y", function(d) {
            return yScale(d);
          })
          .attr("width", xScale.bandwidth())
          .attr("height", function(d) {
            return h - yScale(d) - padding;
          })
          .attr("fill", function(d) {
            return "rgb(255, 0, 0)";
          });
      }
      var CreateGraphLabels = function(graphLabelsElem,svgElem,yScale) {
        graphLabelsElem
            .selectAll("text")
            .data(dataset)
            .enter()
            .append("text")
            .text(function(d) {
              return d.Category + " " + d.Freshness;
            })
            .attr("x", function(d, i) {
                return w + padding2 + (h/15)+ padding2;	//Bar width of 20 plus 1 for padding
             })
            .attr("y", function(d, i) {
              return i*padding2*2 +(h -((dataset.length-1)*19 + (dataset.length)*(h/15)))/2 + h/15/2;
            })
            .attr("width", h / 15)
            .attr("height", function(d) {
              return h / 15;
            })
            .on("click", function(d, i) {
              yScale.domain([0, d3.max(ukpData[i])])
              yAxis = d3.axisLeft(yScale).ticks(5);
              svgElem.select(".y")
              .transition()
              .duration(1000)
              .call(yAxis);
              svgElem.select("#graph").selectAll("rect")
                .data(ukpData[i])
                .transition()
                .duration(1000)
                .attr("y", function(d) {
                  return yScale(d);
                })
                .attr("height", function(d) {
                  return h - yScale(d) - padding;
                })
                .attr("fill", function(d) {
                  if(i == 0) {
                    return "red";
                  }else if(i == 1) {
                    return "blue";
                  }else if(i == 2) {
                    return "green";
                  }else {
                    return "yellow";
                  }
                });
            });
      }
      var CreateGraphLabelRects = function(element) {
        element
          .selectAll("rect")
          .data(dataset)
          .enter()
          .append("rect")
          .attr("x", function(d, i) {
              return w + padding2;	//Bar width of 20 plus 1 for padding
           })
          .attr("y", function(d, i) {
            return i*padding2*2 +(h -((dataset.length-1)*19 + (dataset.length)*(h/15)))/2;
          })
          .attr("width", h / 15)
          .attr("height", function(d) {
            return h / 15;
          })
          .attr("fill", function(d, i) {
            if(i == 0) {
              return "red";
            }else if(i == 1) {
              return "blue";
            }else if(i == 2) {
              return "green";
            }else {
              return "yellow";
            }
          });
      }
      var ExtractUKP = function(dataset) {
        var ukpArray = [];
        for (var i = 0; i < dataset.length; i++) {
          ukpArray.push([
          dataset[i].Jan,dataset[i].Feb,
          dataset[i].Mar,dataset[i].Apr,
          dataset[i].May,dataset[i].Jun,
          dataset[i].Jul,dataset[i].Aug,
          dataset[i].Sep,dataset[i].Oct,
          dataset[i].Nov,dataset[i].Dec]);
        }
        return  ukpArray;
      }




    var rowConverter2 = function(row) {
      return {
        Year: parseInt(row.Year),
        Athlete: row.Athlete,
        Country_State: row.Country_State,
        Time: CalculateTimeUsed(row.Time)
      };
    };

    var rowConverter3 = function(row) {
      return {
        Index: parseInt(row.Index),
        Year: parseInt(row.Year),
        Athlete: row.Athlete,
        Country_State: row.Country_State,
        Time: CalculateTimeUsed2(row.Time)
      };
    };

    d3.csv("MaratonMen.csv", rowConverter2, function(data) {
      d3.csv("MaratonWomen.csv", rowConverter2, function(dataWomen) {
        d3.csv("Maraton2.csv", rowConverter3, function(dataTotal) {
          console.log(dataTotal);
        var w = 500;
        var h = 300;
        var w2 = w + 100;
        var padding = 35;

        var elements = CreateSvgAndGroupElements2(w2,h);

        var AtleteData = GetYearAndTime(data);
        var AtleteDataWomen = GetYearAndTime(dataWomen);

        var rmax = d3.max(AtleteData, function(d) {
          return d[1];
        });

        var rmin = d3.min(AtleteData, function(d) {
            return d[1];
        });


        var xScale = GetXScale2(AtleteData,w,h,padding);
        var yScale = GetYScale2(rmin,rmax,h,padding);
        var rScale = GetRScale(rmax);
        var aScale = GetAScale(rmax);

        CreateXAxis2(elements.graph,h,padding,xScale);
        CreateYAxis2(elements.graph,padding,yScale);

        CreateCircles(elements.graph,AtleteData,xScale,yScale);
        CreateLines(elements.graph,dataTotal,xScale,yScale,"line");
        CreateCircles(elements.graph,AtleteDataWomen,xScale,yScale);
        CreateLines(elements.graph,dataTotal,xScale,yScale,"line2");



        CreateGraphLabels2(elements.graphLabels,w,h,yScale,AtleteData,AtleteDataWomen);
        });
      });
    });

    var GettimeMinMax = function() {

    }

    var CreateGraphLabels2 = function(graphLabelsElem,w,h,yScale,dataMen,dataWomen,rmin,rmax) {
        var gender = ["Men","Women", "Both"];
        graphLabelsElem
            .selectAll("text")
            .data(gender)
            .enter()
            .append("text")
            .text(function(d) {
              return d;
            })
            .attr("x", function(d, i) {
                return w;	//Bar width of 20 plus 1 for padding
             })
            .attr("y", function(d, i) {
              return h / 4 * i + h / 4;
            })
            .on("click", function(d,i) {
              if(gender[i] == "Men") {
                yScale.domain([0, d3.max(ukpData[i])])
              } else if(gender[i] == "Women") {
                yScale.domain([0, d3.max(ukpData[i])])
              } else {
                yScale.domain([0, d3.max(ukpData[i])])
              }

              d3.axisLeft(yScale).ticks(5);
            });
    };

    var CreateSvgAndGroupElements2 = function(w,h) {
        var svg = d3.select("body")
						.append("svg")
						.attr("width", w)
						.attr("height", h);

        var graphLabelsElem = svg.append("g");
        var graphElem = svg.append("g");

          return {
            svg: svg,
            graphLabels: graphLabelsElem,
            graph: graphElem
          };
        }

    var CreateClipPath = function(svg,w,h,padding) {
      svg.append("clipPath")
          .attr("id", "chart-area")
          .append("rect")
          .attr("x", padding)
          .attr("y", padding)
          .attr("width", w - padding)
          .attr("height", h - padding);

    }

    var CreateCircles = function(svg,AtleteData,xScale,yScale) {
      //Create circles
      svg.append("g")
          .attr("id", "circles")
          .attr("clip-path", "url(#chart-area)")
          .selectAll("circle")
          .data(AtleteData)
          .enter()
          .append("circle")
          .attr("cx", function(d) {
            return xScale(d[0]);
          })
          .attr("cy", function(d) {
            return yScale(d[1]);
          })
          .attr("r", function(d) {
            return 2;
          });
    }


    var CreateLines = function(svg,AtleteData,xScale,yScale,classname) {
      if(classname == "line") {
        var line = d3.line()
              .defined(function(d) {
                //console.log(d);
                return d.Index < 121; })
              .x(function(d) { return xScale(d.Year); })
              .y(function(d) { return yScale(d.Time); });
      }else {
        console.log("i am here");
        var line = d3.line()
              .defined(function(d) { return d.Index > 120; })
              .x(function(d) { return xScale(d.Year); })
              .y(function(d) { return yScale(d.Time); });
      }


      svg.append("g")
        .datum(AtleteData)
        .attr("class", classname)
        .attr("d", line);

    }


    var CreateYAxis2 = function(svg,padding,yScale) {
      var yAxis = d3.axisLeft(yScale)
          .ticks(10);

      svg.append("g")
   				.attr("class", "y axis")
          .attr("transform", "translate(" + padding + ",0)")
   				.call(yAxis);
    }

    var CreateXAxis2 = function(svg,h,padding,xScale) {
      var xAxis = d3.axisBottom(xScale)
          .ticks(10)
          .tickFormat(d3.format("d"));

      svg.append("g")
   				.attr("class", "x axis")
          .attr("transform", "translate(0," + (h - padding) + ")")
   				.call(xAxis);
    };

    var GetAScale = function(rmax) {
      var aScale = d3.scaleSqrt()
          .domain([0, rmax])
          .range([0, 10]);
      return aScale;
    };

    var GetRScale = function(rmax) {
      var rScale = d3.scaleLinear()
          .domain([0, rmax])
          .range([2, 5]);
      return rScale;
    };

    var GetXScale2 = function(AtleteData,w,h,padding) {
      var xScale = d3.scaleLinear()
        .domain([d3.min(AtleteData, function(d) {
          return d[0];
        }), d3.max(AtleteData, function(d) {
          return d[0];
        })])
        .range([padding, w - padding*2]);
      return xScale;
    }

    var GetYScale2 = function(rmin,rmax,h,padding) {
      var yScale = d3.scaleLinear()
          .domain([rmin, rmax])
          .range([h - padding, padding]);

      return yScale;
    }

    var formatTime = d3.timeFormat("%Y");
    var hourParser = d3.timeParse("%H:%M:%S");
    var hourParser2 = d3.timeParse("%H.%M.%S");
    var hourFormater = d3.timeFormat("%H");
    var minuteFormater = d3.timeFormat("%M");

    var CalculateTimeUsed = function(time) {
        var userTime = hourParser(time);
        var Hours = parseInt(hourFormater(userTime));
        var minutes = parseInt(minuteFormater(userTime));

        //console.log(Hours*60+minutes);
        return Hours*60+minutes;
    }

    var CalculateTimeUsed2 = function(time) {
        var userTime = hourParser2(time);
        var Hours = parseInt(hourFormater(userTime));
        var minutes = parseInt(minuteFormater(userTime));

        //console.log(Hours*60+minutes);
        return Hours*60+minutes;
    }

    var GetSVG = function() {
      var svg = d3.select("body")
						.append("svg")
						.attr("width", w2)
						.attr("height", h2);
      return svg;
    }

    var GetYearAndTime = function(data) {
      var AtleteData = [];
      for (var i = 0; i < data.length-1; i++) {
        AtleteData.push([data[i].Year, data[i].Time]);					//Add new number to array
      }
      return AtleteData;
    }

    var GetYearAndTime2 = function(data) {
      var AtleteData = [];

    }




    </script>


    <p class="p-custom">If you miss the month of September, you might be behind the fruit curve, but there are plenty more months of vegetables left.
      The chart shows that fresh vegetables are available 9 out of 12 months, but fruit is only available 5 out of 12. Now if only
      we could quantify how delicious the produce is…</p>
    <p class="p-custom">Data from: <a href="http://www.grownyc.org/greenmarket/whatsavailable">
      http://www.grownyc.org/greenmarket/whatsavailable</a></p>
    </div>

    <div id = Part4>
      <h2>Part 4: Viz 2</h2>
    </div>

	</body>

</html>
